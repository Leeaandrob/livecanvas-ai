# OpenAPI Specification Template
# Version: 3.0.3
# Documentation: https://swagger.io/specification/

openapi: 3.0.3

info:
  title: "[API Name]"
  description: |
    [Detailed description of the API]

    ## Overview
    [What this API does and who it's for]

    ## Authentication
    [How to authenticate with this API]

    ## Rate Limiting
    [Rate limiting policies]

    ## Versioning
    [API versioning strategy]
  version: "1.0.0"
  contact:
    name: "[Team Name]"
    email: "[email]"
    url: "[documentation url]"
  license:
    name: "MIT"
    url: "https://opensource.org/licenses/MIT"

servers:
  - url: "http://localhost:3000/api/v1"
    description: "Development server"
  - url: "https://staging-api.example.com/v1"
    description: "Staging server"
  - url: "https://api.example.com/v1"
    description: "Production server"

tags:
  - name: "[Resource 1]"
    description: "Operations related to [Resource 1]"
  - name: "[Resource 2]"
    description: "Operations related to [Resource 2]"
  - name: "Health"
    description: "Health check endpoints"

paths:
  # ============================================
  # RESOURCE 1 ENDPOINTS
  # ============================================

  /resources:
    get:
      tags:
        - "[Resource 1]"
      summary: "List all resources"
      description: "Returns a paginated list of resources"
      operationId: "listResources"
      parameters:
        - $ref: "#/components/parameters/PageParam"
        - $ref: "#/components/parameters/LimitParam"
        - $ref: "#/components/parameters/SortParam"
        - name: "status"
          in: "query"
          description: "Filter by status"
          required: false
          schema:
            type: "string"
            enum: ["active", "inactive", "pending"]
        - name: "search"
          in: "query"
          description: "Search term"
          required: false
          schema:
            type: "string"
            minLength: 2
            maxLength: 100
      responses:
        "200":
          description: "Successful response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResourceListResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "500":
          $ref: "#/components/responses/InternalError"
      security:
        - BearerAuth: []

    post:
      tags:
        - "[Resource 1]"
      summary: "Create a new resource"
      description: "Creates a new resource with the provided data"
      operationId: "createResource"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateResourceRequest"
            examples:
              basic:
                summary: "Basic example"
                value:
                  name: "Example Resource"
                  description: "This is an example"
              full:
                summary: "Full example with all fields"
                value:
                  name: "Full Resource"
                  description: "This is a complete example"
                  metadata:
                    key: "value"
      responses:
        "201":
          description: "Resource created successfully"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResourceResponse"
          headers:
            Location:
              description: "URL of the created resource"
              schema:
                type: "string"
                format: "uri"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "409":
          $ref: "#/components/responses/Conflict"
        "422":
          $ref: "#/components/responses/UnprocessableEntity"
        "500":
          $ref: "#/components/responses/InternalError"
      security:
        - BearerAuth: []

  /resources/{id}:
    parameters:
      - $ref: "#/components/parameters/ResourceId"

    get:
      tags:
        - "[Resource 1]"
      summary: "Get a resource by ID"
      description: "Returns a single resource by its ID"
      operationId: "getResource"
      responses:
        "200":
          description: "Successful response"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResourceResponse"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalError"
      security:
        - BearerAuth: []

    put:
      tags:
        - "[Resource 1]"
      summary: "Update a resource"
      description: "Updates an existing resource"
      operationId: "updateResource"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateResourceRequest"
      responses:
        "200":
          description: "Resource updated successfully"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResourceResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "404":
          $ref: "#/components/responses/NotFound"
        "409":
          $ref: "#/components/responses/Conflict"
        "422":
          $ref: "#/components/responses/UnprocessableEntity"
        "500":
          $ref: "#/components/responses/InternalError"
      security:
        - BearerAuth: []

    delete:
      tags:
        - "[Resource 1]"
      summary: "Delete a resource"
      description: "Deletes a resource by ID"
      operationId: "deleteResource"
      responses:
        "204":
          description: "Resource deleted successfully"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalError"
      security:
        - BearerAuth: []

  # ============================================
  # HEALTH ENDPOINTS
  # ============================================

  /health:
    get:
      tags:
        - "Health"
      summary: "Health check"
      description: "Returns the health status of the API"
      operationId: "healthCheck"
      responses:
        "200":
          description: "API is healthy"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthResponse"
        "503":
          description: "API is unhealthy"
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthResponse"
      security: []

components:
  # ============================================
  # SCHEMAS
  # ============================================

  schemas:
    # Base Resource
    Resource:
      type: "object"
      required:
        - "id"
        - "name"
        - "createdAt"
      properties:
        id:
          type: "string"
          format: "uuid"
          description: "Unique identifier"
          example: "550e8400-e29b-41d4-a716-446655440000"
        name:
          type: "string"
          minLength: 1
          maxLength: 255
          description: "Resource name"
          example: "Example Resource"
        description:
          type: "string"
          maxLength: 1000
          description: "Resource description"
          example: "This is an example description"
        status:
          type: "string"
          enum: ["active", "inactive", "pending"]
          default: "active"
          description: "Resource status"
        metadata:
          type: "object"
          additionalProperties: true
          description: "Additional metadata"
        createdAt:
          type: "string"
          format: "date-time"
          description: "Creation timestamp"
        updatedAt:
          type: "string"
          format: "date-time"
          description: "Last update timestamp"

    # Request Schemas
    CreateResourceRequest:
      type: "object"
      required:
        - "name"
      properties:
        name:
          type: "string"
          minLength: 1
          maxLength: 255
          description: "Resource name"
        description:
          type: "string"
          maxLength: 1000
          description: "Resource description"
        metadata:
          type: "object"
          additionalProperties: true
          description: "Additional metadata"

    UpdateResourceRequest:
      type: "object"
      properties:
        name:
          type: "string"
          minLength: 1
          maxLength: 255
          description: "Resource name"
        description:
          type: "string"
          maxLength: 1000
          description: "Resource description"
        status:
          type: "string"
          enum: ["active", "inactive", "pending"]
          description: "Resource status"
        metadata:
          type: "object"
          additionalProperties: true
          description: "Additional metadata"

    # Response Schemas
    ResourceResponse:
      type: "object"
      properties:
        data:
          $ref: "#/components/schemas/Resource"

    ResourceListResponse:
      type: "object"
      properties:
        data:
          type: "array"
          items:
            $ref: "#/components/schemas/Resource"
        pagination:
          $ref: "#/components/schemas/Pagination"

    Pagination:
      type: "object"
      properties:
        page:
          type: "integer"
          minimum: 1
          example: 1
        limit:
          type: "integer"
          minimum: 1
          maximum: 100
          example: 20
        total:
          type: "integer"
          minimum: 0
          example: 100
        totalPages:
          type: "integer"
          minimum: 0
          example: 5

    # Error Schemas
    Error:
      type: "object"
      required:
        - "code"
        - "message"
      properties:
        code:
          type: "string"
          description: "Error code"
          example: "VALIDATION_ERROR"
        message:
          type: "string"
          description: "Human-readable error message"
          example: "Validation failed"
        details:
          type: "array"
          items:
            $ref: "#/components/schemas/ErrorDetail"

    ErrorDetail:
      type: "object"
      properties:
        field:
          type: "string"
          description: "Field that caused the error"
          example: "email"
        message:
          type: "string"
          description: "Error message for this field"
          example: "Must be a valid email address"
        code:
          type: "string"
          description: "Error code for this field"
          example: "INVALID_FORMAT"

    # Health Schema
    HealthResponse:
      type: "object"
      properties:
        status:
          type: "string"
          enum: ["healthy", "unhealthy", "degraded"]
          example: "healthy"
        timestamp:
          type: "string"
          format: "date-time"
        version:
          type: "string"
          example: "1.0.0"
        services:
          type: "object"
          additionalProperties:
            type: "object"
            properties:
              status:
                type: "string"
                enum: ["up", "down"]
              latency:
                type: "integer"
                description: "Latency in milliseconds"

  # ============================================
  # PARAMETERS
  # ============================================

  parameters:
    ResourceId:
      name: "id"
      in: "path"
      required: true
      description: "Resource ID"
      schema:
        type: "string"
        format: "uuid"

    PageParam:
      name: "page"
      in: "query"
      description: "Page number"
      required: false
      schema:
        type: "integer"
        minimum: 1
        default: 1

    LimitParam:
      name: "limit"
      in: "query"
      description: "Items per page"
      required: false
      schema:
        type: "integer"
        minimum: 1
        maximum: 100
        default: 20

    SortParam:
      name: "sort"
      in: "query"
      description: "Sort field and direction (e.g., 'createdAt:desc')"
      required: false
      schema:
        type: "string"
        pattern: "^[a-zA-Z]+:(asc|desc)$"

  # ============================================
  # RESPONSES
  # ============================================

  responses:
    BadRequest:
      description: "Bad request - Invalid input"
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "BAD_REQUEST"
            message: "Invalid request parameters"
            details:
              - field: "name"
                message: "Name is required"
                code: "REQUIRED"

    Unauthorized:
      description: "Unauthorized - Authentication required"
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "UNAUTHORIZED"
            message: "Authentication required"

    Forbidden:
      description: "Forbidden - Insufficient permissions"
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "FORBIDDEN"
            message: "Insufficient permissions to perform this action"

    NotFound:
      description: "Not found - Resource doesn't exist"
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "NOT_FOUND"
            message: "Resource not found"

    Conflict:
      description: "Conflict - Resource already exists"
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "CONFLICT"
            message: "Resource already exists"

    UnprocessableEntity:
      description: "Unprocessable entity - Validation failed"
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "VALIDATION_ERROR"
            message: "Validation failed"
            details:
              - field: "email"
                message: "Invalid email format"
                code: "INVALID_FORMAT"

    InternalError:
      description: "Internal server error"
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/Error"
          example:
            code: "INTERNAL_ERROR"
            message: "An unexpected error occurred"

  # ============================================
  # SECURITY SCHEMES
  # ============================================

  securitySchemes:
    BearerAuth:
      type: "http"
      scheme: "bearer"
      bearerFormat: "JWT"
      description: "JWT Bearer token authentication"

    ApiKeyAuth:
      type: "apiKey"
      in: "header"
      name: "X-API-Key"
      description: "API Key authentication"

security:
  - BearerAuth: []
